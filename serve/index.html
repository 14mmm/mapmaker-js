<!doctype html>
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="css/metamapsMapRender.css" />
		<link rel="stylesheet" type="text/css" href="js/bower_components/famous/dist/famous.css" />
		<style>
			html * {
				box-sizing: border-box;
			}
			#mapCanvas {
				border   : 1px solid black;
				position : absolute;
				top      : 10px;
				bottom   : 10px;
				left     : 10px;
				right    : 150px;
			}
			#controls {
				position : absolute;
				top      : 10px;
				bottom   : 10px;
				right    : 0px;
				width    : 140px;
			}
		</style>
	</head>
	<body>
		<div id="mapCanvas"></div>
		<div id="controls">
			<div>
				<button id="zoomIn">Zoom In</button>
			</div>
		</div>
		<script src="js/bower_components/jquery/dist/jquery.min.js"></script>
		<script src="js/metamaps_renderer.js"></script>
		<script>
			var map;

			function start(data) {
				var topicMappings, synapseMappings;

				if (data) {
					map = new Metamaps.Map(data.map);

					map.set('topics', new Metamaps.TopicCollection(data.topics));
		            map.set('synapses', new Metamaps.SynapseCollection(data.synapses));
		            
		            topicMappings = _.where(data.mappings, {category: "Topic"});
		            map.set('topicMappings', new Metamaps.MappingCollection(topicMappings));

		            synapseMappings = _.where(data.mappings, {category: "Synapse"});;
		            map.set('synapseMappings', new Metamaps.MappingCollection(synapseMappings));
				}

				var XLOC = 560;
	      		var YLOC = 0;
	      		var XLOC2 = 0;
	      		var YLOC2 = 0;

				var config = {};
				var canvasEl = document.getElementById("mapCanvas");
				var renderer = Metamaps.MapRendererFactory.create(
					canvasEl,
					config,
					map);
				$(renderer).on(Metamaps.MapRenderer.events.message, function (event, message) {
						console.log(message);
				});
			};

			$.ajax({
	            url: "/json/testdata/map1113.json",
	            success: start
	        });
		</script>
	</body>
</html>
